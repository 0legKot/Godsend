<h1>Product detail</h1>
<br />
<br />
<br />
<div class="wrap rel">
    <br />
    <br />
    <div class="edit-prod">
        <div class="inline-block edit-btns" id="edit" *ngIf="!edit" (click)="editMode()"> Edit</div>
        <div class="inline-block edit-btns" id="save" *ngIf="edit" (click)="save()"> Save</div>
        <div class="inline-block edit-btns" id="discard" *ngIf="edit" (click)="discard()"> Discard</div>
        <div id="delete" class="edit-btns inline-block " (click)="deleteProduct()">Delete</div>
    </div>
    <br />
    <div class='container-fluid'>
        <div class='row'>
            <div class='col-lg-3 col-md-4 col-sm-6 col-xs-12 products'>
                <div class="prod-name">
                    <godsend-input-output *ngIf="data" [(ngModel)]="data.product.info.name" [edit]="edit"></godsend-input-output>
                </div>
                <div class="photo">
                    <div *ngFor="let image of images" style="display:contents;">
                        <img [src]="'data:image/jpg;base64,' + image" width="50%" />
                    </div>
                </div>
                <div class="rating">
                    <div *ngIf="data">
                        <godsend-ratings [clas]="clas" [id]="data.product.id" [(ngModel)]="data.product.info.rating"></godsend-ratings>
                    </div>
                    <p class="pull-right" [ngStyle]="{'color': '#003e09' }"><fa name="eye"></fa> : {{ data?.product?.info?.watches }}</p>
                </div>
            </div>
            <div class='col-lg-7 col-md-6 col-sm-5 col-xs-12 products rel'>
                <div class="prod-info">
                    <div>
                        <label>Description: </label>
                        <p><godsend-input-output *ngIf="data" [(ngModel)]="data.product.info.description" [edit]="edit" [type]="'huge'"></godsend-input-output></p>
                    </div>

                    <!-- PROPERTIES -->
                    <div>

                        <div *ngIf="data && data.product.decimalProps">
                            <div *ngFor="let dProp of data.product.decimalProps">
                                <label> {{ dProp.property.name }}</label>
                                <godsend-input-output [(ngModel)]="dProp.value" [edit]="edit" [type]="'decimal'"></godsend-input-output>
                            </div>
                        </div>

                        <div *ngIf="data && data.product.intProps">
                            <div *ngFor="let iProp of data.product.intProps">
                                <label> {{ iProp.property.name }}</label>
                                <godsend-input-output [(ngModel)]="iProp.value" [edit]="edit" [type]="'integer'"></godsend-input-output>
                            </div>
                        </div>

                        <div *ngIf="data && data.product.stringProps">
                            <div *ngFor="let sProp of data.product.stringProps">
                                <label> {{ sProp.property.name }}</label>
                                <godsend-input-output [(ngModel)]="sProp.value" [edit]="edit"></godsend-input-output>
                            </div>
                        </div>

                    </div>
                    <!-- END PROPERTIES -->

                    <div *ngIf="data?.suppliers?.length > 0 else noSuppliers">
                        <label>Price: </label>
                        <p>
                            <span>From: </span>
                            <select [(ngModel)]="selectedSupplier" *ngIf="data != null">
                                <option *ngFor="let s of data?.suppliers" [ngValue]="s">{{ s.supplier?.info?.name }} for {{ s.price }}</option>
                            </select>
                        </p>
                        <p> For: {{ price }}</p>
                        <label>Quantity: </label>
                        <p><input id="input-quantity" type="number" min="1" step="1" [(ngModel)]="quantity" /></p>
                        <div class="buy" (click)="buy()">
                            <p class="inline-block"><fa name="cart-arrow-down"></fa></p>
                            <p class="inline-block">Buy!</p>
                        </div>

                        <div>
                            <span>Filter selection</span>
                            <godsend-search-inline [type]="searchTypeSupplier" (found)="refreshFoundSuppliers($event)"></godsend-search-inline>
                            <div *ngIf="foundSuppliers != null">
                                <label>Supplier: </label>
                                <select [(ngModel)]="supplierToAdd">
                                    <option *ngFor="let s of foundSuppliers" [ngValue]="s"> {{ s.name }}</option>
                                </select>
                                <label>Price: </label>
                                <input [(ngModel)]="priceToAdd" type="number" />
                                <button (click)="addSupplier()">Add</button>
                                
                            </div>

                        </div>
                    </div>
                    <ng-template #noSuppliers>
                        <label>No suppliers</label>
                    </ng-template>


                    <div *ngIf="data">
                        <label>Category: </label>
                        <div>
                            <span>{{ data.product.jsonCategory.name }}</span>
                        </div>

                        <div *ngIf="edit">
                            <godsend-category-tree (categoryChanged)="changeCategory($event)"></godsend-category-tree>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <godsend-comment-wrapper id="{{route.snapshot.params.id}}" clas="product"></godsend-comment-wrapper>
    <div class="back-btn" (click)="gotoProducts(prod)">
        <fa name="long-arrow-left"></fa> Back to products
    </div>

</div>
